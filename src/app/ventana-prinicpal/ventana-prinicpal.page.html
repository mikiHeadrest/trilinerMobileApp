<ion-header [translucent]="true" class="headerClass">
  <div style="height: 25%; background-color: aliceblue">
    <br />
  </div>

  <div class="headerContent">
    <ion-avatar style="height: 50px; width: 50px; border: solid #d2f1ee 1px">
      <img
        src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQl-DxLh4oV1NCm2a101jtYxOimBnLZNkiiBQ&s"
      />
    </ion-avatar>

    <span>
      Bienvenido <span> <b> Juan Manuel Valdez Lerma </b> </span>
    </span>
  </div>
</ion-header>

<ion-content [fullscreen]="true" class="homeContent">
  <!-- Refrescar -->
  <ion-refresher slot="fixed" (ionRefresh)="handleRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>
  <!-- Contenedor: Estado Actual -->
  <ion-card class="estado-card">
    <div class="estado-container">
      <img src="https://panel.gilygil.com/resources/noticias/63da814912349.jpg" class="estado-img" />
      <div class="estado-texto">
        <h2 class="textm">Modelo: 0000 0000 0001</h2>
        <p class="texte">
          <strong> Estado Actual: {{estado}}</strong>
        </p>
      </div>
    </div>
  </ion-card>

  <!-- Contenedor: Metricas del Día -->
  <ion-card class="content-card">
      <p class="textd">El día de hoy se han realizado:</p>
    <ion-card-content class="containerTrans">
      <div
        style="
          display: flex;
          justify-content: space-around;
          align-items: center;
        "
      >
        <div>
          <h1 style="color: #dcd3a3">
             @if(todaysoperations.totalrecepcion == null){
              0
            }
            @else{
              {{todaysoperations.totalrecepcion}}
            }
          </h1>
          <p style="color: #d3ba79">Transacciones de Recepción</p>
        </div>
        <div>
          <p style="font-size: 48px; color: #c3ddd8">|</p>
        </div>
        <div>
          <h1 style="color: #c3ddd8">
            @if(todaysoperations.totaldespacho == null){
              0
            }
            @else{
              {{todaysoperations.totaldespacho}}
            }
          </h1>
          <p style="color: #bfd3d0">Transacciones de Despacho</p>
        </div>
      </div>
    </ion-card-content>
  </ion-card>

  <!-- Contenedor: Historial de Operaciones -->
  <ion-card-title style="color: #bfd3d0; margin-left: 16px">
    Historial de Operaciones Más Recientes
  </ion-card-title>

  <ion-card>
    <ion-card-content class="item">
      <ion-item class="custom-item" *ngFor="let op of mainRecentElements()">
        <ion-avatar class-="img-container" slot="start">
          <img [src]="op.imagen" alt="Producto" />
        </ion-avatar>
        <ion-label>
          <h3>{{ op.nombre }}</h3>
          <p>
            Tipo de Operacion:
            @if(op.tipo_operacion){
              Recepcion
            }
            @else{
              Despacho
            }
            - {{ op.unidades }} unidad(es)<br />
            <!-- ID Montacargas: {{ op.idMontacargas }}<br /> -->
            <!-- Origen: {{ op.origen }}<br />  rip-->
            Fecha: {{ op.modified_at | date: 'dd/MM/yyyy HH:mm' }}
          </p>
        </ion-label>
      </ion-item>
    </ion-card-content>
  </ion-card>

  <!-- Contenedor: Consultas Transaccionales -->
  <div class="contenido">
    <ion-title class="titulo" style="color: #dcd3a3">
      Consultas Transaccionales
    </ion-title>

    <!-- Consulta de Mayor Numero de Despachos -->
    @if(mostDeliveries.totalunidades > 0){
      <ion-card class="tarjeta">
        <ion-card-header class="tarjeta-header">
          <ion-card-title
          [style.color]="mostDeliveries.imagen ? '#dcd3a3' : 'white'"
          style="font-size:16px"
          >
          Producto con mayor numero de despachos
        </ion-card-title>
        </ion-card-header>

        <ion-card-content class="tarjeta-body">
          <ion-avatar slot="start">
            <img src="{{mostDeliveries.imagen}}">
          </ion-avatar>

          <div class="info">
            <h3 style="color: #dcd3a3">{{ mostDeliveries.nombre }}</h3>
            <small>ID Producto: {{ mostDeliveries.id_producto }}</small>
          </div>
          <div class="dato">
            <span>Unidades:</span>
            <h1 style="color: #dcd3a3">{{ mostDeliveries.totalunidades }}</h1>
          </div>

        </ion-card-content>
      </ion-card>
    }

    <!-- Consulta de Mayor Numero en Stock -->
    @if(mostStored.totalunidades > 0){
      <ion-card class="tarjeta">
        <ion-card-header class="tarjeta-header">
          <ion-card-title
          [style.color]="mostStored.imagen ? '#dcd3a3' : 'white'"
          style="font-size:16px"
          >
          Producto con mayor unidades disponibles
        </ion-card-title>
        </ion-card-header>

        <ion-card-content class="tarjeta-body">
          <ion-avatar slot="start">
            <img src="{{mostStored.imagen}}">
          </ion-avatar>

          <div class="info">
            <h3 style="color: #dcd3a3">{{ mostStored.nombre }}</h3>
            <small>ID Producto: {{ mostStored.id_producto }}</small>
          </div>
          <div class="dato">
            <span>Unidades:</span>
            <h1 style="color: #dcd3a3">{{ mostStored.totalunidades }}</h1>
          </div>

        </ion-card-content>
      </ion-card>
    }

    <!-- Dia con mayor numero de operaciones -->
    @if(dateMostMovement.totaldemovimientos > 0){
      <ion-card class="tarjeta">
        <ion-card-header class="tarjeta-header">
          <ion-card-title
          style="font-size:16px; color:white;"
          >
          Dia con mayor número de Operaciones
        </ion-card-title>
        </ion-card-header>

        <ion-card-content class="tarjeta-body">
          <div
            class="info"
            style="display: flex; align-items: center; gap: 10px"
          >
            <ion-icon
              name="calendar-outline"
              style="font-size: 50px; color: white"
            ></ion-icon>
            <div>
              <h3 style="color: white">Fecha: {{ dateMostMovement.fecha }}</h3>
              <small>
                Operaciones de Recepción: {{ dateMostMovement.totalrecepcion }}<br />
                Operaciones de Despacho: {{ dateMostMovement.totaldespacho }}
              </small>
            </div>
          </div>

          <div class="dato">
            <span>Total de Operaciones:</span>
            <h1 style="color: white">{{ dateMostMovement.totaldemovimientos }}</h1>
          </div>

        </ion-card-content>
      </ion-card>
    }

    </div>
  </ion-content>

